<!-- MHonArc v2.6.24 -->
<!--X-Subject: Re: [Omaha.pm] Fork with a disown -->
<!--X-From-R13: Quevfgbcure Qnfuryy &#60;gbcure&#45;czNmlc.bet> -->
<!--X-Date: 29 Nov 2011 04:21:41 &#45;0000 -->
<!--X-Message-Id: CACCJnx2gduwsWH57xsEy1EiBdQWpw_Rf61x8_AubbqRk=jxLUw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAPzVKwb01&#45;73yYm3_7J=hJL57sGCu=NYijVRajcCA3Zr_ri+EQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [Omaha.pm] Fork with a disown</title>
<link rev="made" href="mailto:topher-pm@zyp.org">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02758.html">Date Prev</a>][<a href="msg02760.html">Date Next</a>][<a href="msg02758.html">Thread Prev</a>][<a href="msg02760.html">Thread Next</a>][<a href="maillist.html#02759">Date Index</a>][<a href="threads.html#02759">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [Omaha.pm] Fork with a disown</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
<li><em>Subject</em>: Re: [Omaha.pm] Fork with a disown</li>
<li><em>From</em>: Christopher Cashell &lt;<a href="mailto:topher-pm%40zyp.org">topher-pm@zyp.org</a>&gt;</li>
<li><em>Date</em>: Mon, 28 Nov 2011 22:20:58 -0600</li>
<li><em>Delivered-to</em>: <a href="mailto:mailman-omaha-pm%40mailman.pm.dev">mailman-omaha-pm@mailman.pm.dev</a></li>
<li><em>Delivered-to</em>: <a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=mime-version:sender:in-reply-to:references:from:date	:x-google-sender-auth:message-id:subject:to:content-type;	bh=esE1sejJ0tnHNWSBdadRN/u/UwjPI50JSCt8WrKfVOk=;	b=HjLpxauOi4jZ353rnd07VkdXR+XNQJ6Mv+kNBWFjoTcdf0Zg1fPEWxTdr+qRcRcUJp	OOUAl4uKzRbm9Q/ulrmXNdI5qhZuei5B+spAyPuWOAooEOHT2DQswWINIKr1DHb68mHQ	TrGSxcVFpVdvlR84d8U1ZxEU1i0HBIub4W73M=</li>
<li><em>In-reply-to</em>: &lt;CAPzVKwb01-73yYm3_7J=hJL57sGCu=NYijVRajcCA3Zr_ri+EQ@mail.gmail.com&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://mail.pm.org/pipermail/omaha-pm">http://mail.pm.org/pipermail/omaha-pm</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:omaha-pm-request@pm.org?subject=help">mailto:omaha-pm-request@pm.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;omaha-pm.pm.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:omaha-pm@pm.org">mailto:omaha-pm@pm.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://mail.pm.org/mailman/listinfo/omaha-pm">http://mail.pm.org/mailman/listinfo/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=subscribe">mailto:omaha-pm-request@pm.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://mail.pm.org/mailman/options/omaha-pm">http://mail.pm.org/mailman/options/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=unsubscribe">mailto:omaha-pm-request@pm.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;CAPzVKwb01-73yYm3_7J=hJL57sGCu=NYijVRajcCA3Zr_ri+EQ@mail.gmail.com&gt;</li>
<li><em>Reply-to</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:christopher.cashell%40gmail.com">christopher.cashell@gmail.com</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>2011/11/25 Nick Wertzberger &lt;wertnick@gmail.com&gt;:
&gt; Google is not being friendly to me today. What do you guys do to stop a
&gt; child process from being killed on termination of a parent process in perl?
&gt; I would prefer to not do a `nohup $shellCall`, so if you have an
&gt; alternative, I am all ears!

There's a couple of ways to potentially solve this, but the best and
most appropriate one will depend on exactly what you're trying to
accomplish (and I think there may be some terminology confusion, at
least with the traditional concept of forking).

First of all, what event are you referring to with &quot;child process from
being killed on termination of parent process&quot;?  How is the parent
process being terminated?  Is it terminating itself?  Is it crashing?
Is it being killed by the user logging out (which sends the user's
processes a SIGHUP (hangup) signal)?  Or something else?

Also, how are you defining child process here?  Are you actually doing
a fork?  Or are you calling an external process from your script and
waiting (blocking) on the results (like your example, `nohup
$shellCall`)?  If you're calling an external process, is it Perl?  Can
you provide a few more details about what your program is doing?

I was going to throw out a few thoughts on possible solutions, and in
fact originally started doing just that, but the more I thought about
it and reread your question (in particular, the bit about `nohup
$shellCall`, which makes me think you're running a command via that),
the more I feel that my initial solution suggestions aren't going to
be useful and may not fit your situation.

I saw the title of your post and on initial read, I thought you were
doing a fork from within your program, and then the parent process was
dying somehow, which was affecting the child process (although that
normally shouldn't impact the child process much after a fork).  For
that situation, I was going to offer the following suggestions:

The first is to use an external tool to do the work for you, such as
DBJ's daemontools.  There's a handful of options that can do that.

The second is to do a double fork.  This is the most common
do-it-yourself daemon process, and is a fairly common idiom for
daemonizing a process.  The double-fork helps ensure that you are
fully detached from any controlling terminals, and that your process
will be properly cleaned up by init (PID 1).

The third is Perl specific, but the direction I'd probably go with.
It's to use CPAN and a Perl module that does the heavy lifting.  One
I've used in the past is App::Daemon, but there's a couple of similar
ones there, too.

However, now I'm tending to think those solutions will not really
apply.  I think what is probably happening is that you are using qx//
or backticks to run an external program, and trying to capture the
output from that program.  For whatever reason, your parent process is
dying, which is causing the child process to die when the child tries
to write its output back to the parent (doing so after the parent dies
will result in a SIGPIPE signal for a broken pipe (stdout from child
to input on parent), which probably terminates the child.

If the parent is supposed to block until the child is done, and then
read the child's input, then you need to figure out what is killing
the parent and fix that.  If the parent is supposed to execute the
child and never return (parent process is no longer needed), you
should probably be using exec instead of qx// or backticks.  If the
parent process needs to keep running, and you want to run an external
command completely independently of the parent process, you might want
to check out the fork-exec idiom.  In this case, you first do a fork,
then the forked child process immediately does an exec to fire off the
(now independent) external process.

If my guesses above don't answer your question, give us a few more
details on what you're doing and we'll see what else we can come up
with. ;-)

-- 
Christopher

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="02756" href="msg02756.html">[Omaha.pm] Fork with a disown</a></strong>
<ul><li><em>From:</em> Nick Wertzberger &lt;wertnick@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02758.html">Re: [Omaha.pm] Fork with a disown</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02760.html">[Omaha.pm] Coworking in southwest Omaha</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02758.html">Re: [Omaha.pm] Fork with a disown</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02760.html">[Omaha.pm] Coworking in southwest Omaha</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02759"><strong>Date</strong></a></li>
<li><a href="threads.html#02759"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
