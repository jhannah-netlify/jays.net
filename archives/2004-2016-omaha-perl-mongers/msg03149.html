<!-- MHonArc v2.6.24 -->
<!--X-Subject: [Omaha.pm] Template::Alloy contexts -->
<!--X-From-R13: Xnl Vnaanu &#60;wnlNwnlf.arg> -->
<!--X-Date: 18 Oct 2013 15:46:55 &#45;0000 -->
<!--X-Message-Id: 6B2E04B6&#45;A844&#45;4B0B&#45;8449&#45;D13FA8E0582F@jays.net -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 526138B9.2070402@seamons.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[Omaha.pm] Template::Alloy contexts</title>
<link rev="made" href="mailto:jay@jays.net">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg03148.html">Date Prev</a>][<a href="msg03150.html">Date Next</a>][<a href="msg03144.html">Thread Prev</a>][<a href="msg03150.html">Thread Next</a>][<a href="maillist.html#03149">Date Index</a>][<a href="threads.html#03149">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[Omaha.pm] Template::Alloy contexts</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Nebraska USA Perl Mongers of Omaha &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
<li><em>Subject</em>: [Omaha.pm] Template::Alloy contexts</li>
<li><em>From</em>: Jay Hannah &lt;<a href="mailto:jay%40jays.net">jay@jays.net</a>&gt;</li>
<li><em>Date</em>: Fri, 18 Oct 2013 09:46:45 -0600</li>
<li><em>Delivered-to</em>: <a href="mailto:mailman-omaha-pm%40mailman.pm.dev">mailman-omaha-pm@mailman.pm.dev</a></li>
<li><em>Delivered-to</em>: <a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a></li>
<li><em>List-archive</em>: &lt;<a href="http://mail.pm.org/pipermail/omaha-pm/">http://mail.pm.org/pipermail/omaha-pm/</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:omaha-pm-request@pm.org?subject=help">mailto:omaha-pm-request@pm.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;omaha-pm.pm.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:omaha-pm@pm.org">mailto:omaha-pm@pm.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://mail.pm.org/mailman/listinfo/omaha-pm">http://mail.pm.org/mailman/listinfo/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=subscribe">mailto:omaha-pm-request@pm.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://mail.pm.org/mailman/options/omaha-pm">http://mail.pm.org/mailman/options/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=unsubscribe">mailto:omaha-pm-request@pm.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;526138B9.2070402@seamons.com&gt;</li>
<li><em>Reply-to</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style=""><div>... wow. Template::Alloy is ... wow.&nbsp;</div><div><br></div><div>Check it out if you've always wished Perl 5's context stuff was more complicated. &nbsp;:)</div><div><br></div><div>Perl++ # you can do ANYTHING. &nbsp;:)</div><div><br></div><div>j</div><div><br></div><div><br><div><div><br><div>Begin forwarded message:</div><blockquote type="cite"><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><span style="font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>From: </b></span><span style="font-family:'Helvetica'; font-size:medium;">Paul Seamons &lt;<a rel="nofollow" href="mailto:mail@seamons.com">mail@seamons.com</a>&gt;<br></span></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><span style="font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>Subject: </b></span><span style="font-family:'Helvetica'; font-size:medium;"><b>Re: [Templates] force resultset as array</b><br></span></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><span style="font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>Date: </b></span><span style="font-family:'Helvetica'; font-size:medium;">October 18, 2013 7:33:45 AM MDT<br></span></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><span style="font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>To: </b></span><span style="font-family:'Helvetica'; font-size:medium;"><a rel="nofollow" href="mailto:templates@template-toolkit.org">templates@template-toolkit.org</a><br></span></div><br>
  
    
  
  <div bgcolor="#FFFFFF" text="#000000">
    <div class="moz-cite-prefix">On 10/18/2013 05:03 AM, Spevak, Martin
      wrote:<br>
    </div>
    <blockquote cite="" type="cite">
      <pre wrap="">Hello,

I have small problem with TT while getting DBIx::ResultSet. For instance
I have stash variable team which ich DBIx::Result (one entry). In DBIx
exists relations team_accesses as has_many. So in TT I am using:

team_accesses = team.team_accesses;

Problem is: 
	when team has no accesses, variable team_accesses is empty string ('')
	when 1 access exists, variable contain hash which is result
DBIx::TeamAccess. 
	when exists more than 1 access, variable contains array of
DBIx::TreamAccess.
Is the way how to say TT, that result needs to be converted to array?

I tried: team_access = [ team.team_accesses ], but my results are,
[ '' ], [DBIx::Result], [[DBIx::Result]]


</pre>
    </blockquote>
    I had tried to get CALL_CONTEXT added to Template::Toolkit, but as I
    was giving patches for adding various features, it was deemed that
    that would make the grammar grow too large.&nbsp; So, while it isn't a
    good direct answer for how to do it in Template::Toolkit, it is
    possible to do this in Template::Alloy, but either way this portion
    from the Template::Alloy documentation does give more information
    about Template::Toolkit smart context:<br>
    <br>
    <br>
    <dl>
      <dt><a rel="nofollow" name="CALL_CONTEXT_(Not_in_TT)">CALL_CONTEXT (Not in TT)</a></dt>
      <dd><p>Can be one of 'item', 'list', or 'smart'. The default type is
          'smart'. The CALL_CONTEXT configuration specifies in what Perl
          context coderefs and methods used in the processed templates
          will be called. TT historically has avoided the distinction of
          item (scalar) vs list context. To avoid worrying about this,
          TT introduced 'smart' context. The <code>@()</code> and <code>$()</code>
          context specifiers make it easier to use CALL_CONTEXT in some
          situations.</p><p>The following table shows the relationship between the
          various contexts:</p>
        <pre class="sh_perl sh_sourceCode">       <span class="sh_keyword">return</span> <span class="sh_keyword">values</span>      smart context   list context    item context
       <span class="sh_symbol">-------------</span>      <span class="sh_symbol">-------------</span>   <span class="sh_symbol">------------</span>    <span class="sh_symbol">------------</span>
    A   <span class="sh_string">'foo'</span>              <span class="sh_string">'foo'</span>           <span class="sh_symbol">[</span><span class="sh_string">'foo'</span><span class="sh_symbol">]</span>         <span class="sh_string">'foo'</span>
    B   <span class="sh_keyword">undef</span>              <span class="sh_keyword">undef</span>           <span class="sh_symbol">[</span><span class="sh_keyword">undef</span><span class="sh_symbol">]</span>         <span class="sh_keyword">undef</span>
    <span class="sh_function">C</span>   <span class="sh_symbol">(</span>no <span class="sh_keyword">return</span> value<span class="sh_symbol">)</span>  <span class="sh_keyword">undef</span>           <span class="sh_symbol">[]</span>              <span class="sh_keyword">undef</span>
    <span class="sh_function">D</span>   <span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">)</span>                <span class="sh_number">7</span>               <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">]</span>             <span class="sh_number">7</span>
    <span class="sh_function">E</span>   <span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">)</span>            <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>         <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>         <span class="sh_number">9</span>
    F   <span class="sh_variable">@a</span> <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">)</span>           <span class="sh_number">7</span>               <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">]</span>             <span class="sh_number">1</span>
    G   <span class="sh_variable">@a</span> <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">)</span>       <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>         <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>         <span class="sh_number">3</span>
    <span class="sh_function">H</span>   <span class="sh_symbol">(</span><span class="sh_cbracket">{</span>b<span class="sh_symbol">=&gt;</span><span class="sh_string">"c"</span><span class="sh_cbracket">}</span><span class="sh_symbol">)</span>         <span class="sh_cbracket">{</span>b<span class="sh_symbol">=&gt;</span><span class="sh_string">"c"</span><span class="sh_cbracket">}</span>        <span class="sh_symbol">[</span><span class="sh_cbracket">{</span>b<span class="sh_symbol">=&gt;</span><span class="sh_string">"c"</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span>      <span class="sh_cbracket">{</span>b<span class="sh_symbol">=&gt;</span><span class="sh_string">"c"</span><span class="sh_cbracket">}</span>
    <span class="sh_function">I</span>   <span class="sh_symbol">([</span><span class="sh_number">1</span><span class="sh_symbol">])</span>              <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span>             <span class="sh_symbol">[[</span><span class="sh_number">1</span><span class="sh_symbol">]]</span>           <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span>
    <span class="sh_function">J</span>   <span class="sh_symbol">([</span><span class="sh_number">1</span><span class="sh_symbol">],[</span><span class="sh_number">2</span><span class="sh_symbol">])</span>          <span class="sh_symbol">[[</span><span class="sh_number">1</span><span class="sh_symbol">],[</span><span class="sh_number">2</span><span class="sh_symbol">]]</span>       <span class="sh_symbol">[[</span><span class="sh_number">1</span><span class="sh_symbol">],[</span><span class="sh_number">2</span><span class="sh_symbol">]]</span>       <span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span>
    K   <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>            <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>         <span class="sh_symbol">[[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]]</span>       <span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">8</span><span class="sh_symbol">,</span><span class="sh_number">9</span><span class="sh_symbol">]</span>
    <span class="sh_function">L</span>   <span class="sh_symbol">(</span><span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_string">"foo"</span><span class="sh_symbol">)</span>     <span class="sh_keyword">die</span> <span class="sh_string">"foo"</span>       <span class="sh_symbol">[</span><span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_string">"foo"</span><span class="sh_symbol">]</span>  <span class="sh_string">"foo"</span>
    M   <span class="sh_keyword">wantarray</span><span class="sh_symbol">?</span><span class="sh_number">1</span><span class="sh_symbol">:</span><span class="sh_number">0</span>      <span class="sh_number">1</span>               <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span>             <span class="sh_number">0</span></pre><p>Cases F, H, I and M are common sticking points of the smart
          context in TT2. Note that list context always returns an
          arrayref from a method or function call. Smart context can
          give confusing results sometimes, especially the I and J
          cases. Case L for smart match is very surprising.</p><p>The list and item context provide another feature for method
          calls. In smart context, TT will look for a hash key in the
          object by the same name as the method, if a method by that
          name doesn't exist. In item and list context Alloy will die if
          a method by that name cannot be found.</p><p>The CALL_CONTEXT configuration item can be passed to new or
          it may also be set during runtime using the CONFIG directive.
          The following method call would be in list context:</p>
        <pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">[%</span> CONFIG CALL_CONTEXT <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">;</span>
       results <span class="sh_symbol">=</span> my_obj<span class="sh_symbol">.</span>get_results<span class="sh_symbol">;</span>
       CONFIG CALL_CONTEXT <span class="sh_symbol">=&gt;</span> <span class="sh_string">'smart'</span>
    <span class="sh_symbol">%]</span></pre><p>Note that we needed to restore CALL_CONTEXT to the default
          'smart' value. Template::Alloy has added the <code>@()</code>
          (list) and the <code>$()</code> (item) context specifiers.
          The previous example could be written as:</p>
        <pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">[%</span> results <span class="sh_symbol">=</span> @<span class="sh_symbol">(</span> my_obj<span class="sh_symbol">.</span>get_results <span class="sh_symbol">)</span> <span class="sh_symbol">%]</span></pre><p>To call that same method in item (scalar) context you would
          do the following:</p>
        <pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">[%</span> results <span class="sh_symbol">=</span> $<span class="sh_symbol">(</span> my_obj<span class="sh_symbol">.</span>get_results <span class="sh_symbol">)</span> <span class="sh_symbol">%]</span></pre>
      </dd>
    </dl>
  </div>

_______________________________________________<br>templates mailing list<br><a rel="nofollow" href="mailto:templates@template-toolkit.org">templates@template-toolkit.org</a><br>http://mail.template-toolkit.org/mailman/listinfo/templates<br></blockquote></div><br><div apple-content-edited="true">
<span class="Apple-style-span" style="border-collapse: separate; border-spacing: 0px; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-size: medium; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-size: medium; "><span class="Apple-style-span" style="font-family: monospace; "><br class="Apple-interchange-newline"><br></span></span></span></span>
</div>
<br></div></div><br><br>
<br></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg03148.html">Re: [Omaha.pm] [OMG!Code] Tue Oct 8 meeting</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg03150.html">[Omaha.pm] &quot;Make Perl Nerd Merit Badges&quot; on @crowdtilt</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg03144.html">[Omaha.pm] Mojo::DOM CSS selectors sure are handy</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg03150.html">[Omaha.pm] &quot;Make Perl Nerd Merit Badges&quot; on @crowdtilt</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#03149"><strong>Date</strong></a></li>
<li><a href="threads.html#03149"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
