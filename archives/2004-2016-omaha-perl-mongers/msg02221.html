<!-- MHonArc v2.6.24 -->
<!--X-Subject: Re: [Omaha.pm] Self monitoring a perl scripts memory usage... -->
<!--X-From-R13: Xnl Vnaanu &#60;wnlNwnlf.arg> -->
<!--X-Date: 21 Oct 2009 20:40:37 &#45;0000 -->
<!--X-Message-Id: 8FB7FD39&#45;F9D2&#45;4340&#45;A2F6&#45;7804F6AB2389@jays.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 3e2be50910211217o50073897nc0570dc073d4e548@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [Omaha.pm] Self monitoring a perl scripts memory usage...</title>
<link rev="made" href="mailto:jay@jays.net">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02220.html">Date Prev</a>][<a href="msg02222.html">Date Next</a>][<a href="msg02218.html">Thread Prev</a>][<a href="msg02230.html">Thread Next</a>][<a href="maillist.html#02221">Date Index</a>][<a href="threads.html#02221">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [Omaha.pm] Self monitoring a perl scripts memory usage...</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
<li><em>Subject</em>: Re: [Omaha.pm] Self monitoring a perl scripts memory usage...</li>
<li><em>From</em>: Jay Hannah &lt;<a href="mailto:jay%40jays.net">jay@jays.net</a>&gt;</li>
<li><em>Date</em>: Wed, 21 Oct 2009 15:40:31 -0500</li>
<li><em>Delivered-to</em>: <a href="mailto:mailman-omaha-pm%40mailman.pm.dev">mailman-omaha-pm@mailman.pm.dev</a></li>
<li><em>Delivered-to</em>: <a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a></li>
<li><em>In-reply-to</em>: &lt;<a href="msg02218.html">3e2be50910211217o50073897nc0570dc073d4e548@mail.gmail.com</a>&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://mail.pm.org/pipermail/omaha-pm">http://mail.pm.org/pipermail/omaha-pm</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:omaha-pm-request@pm.org?subject=help">mailto:omaha-pm-request@pm.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;omaha-pm.pm.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:omaha-pm@pm.org">mailto:omaha-pm@pm.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://mail.pm.org/mailman/listinfo/omaha-pm">http://mail.pm.org/mailman/listinfo/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=subscribe">mailto:omaha-pm-request@pm.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://mail.pm.org/mailman/options/omaha-pm">http://mail.pm.org/mailman/options/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=unsubscribe">mailto:omaha-pm-request@pm.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg02218.html">3e2be50910211217o50073897nc0570dc073d4e548@mail.gmail.com</a>&gt;</li>
<li><em>Reply-to</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
On Oct 21, 2009, at 2:17 PM, Dan Linder wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
I have a script that usually maxes out around 100MB of memory (viewed
via /proc/&lt;PID&gt;/status and watching the &quot;VmPeak&quot; value).
In one test case, the complexity of the task grows, and the VmPeak
tops out at over 300MB.  The server this is running on has &quot;ulimit -v
256000&quot; (roughly 256MB), so once the script passes 256MB it is killed.
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>Wow. That's a big process.  :)  You have to have all that in memory  
</tt><tt>all at once? Can you cache out some of it or something?  
</tt><tt>(Cache::FileCache?)
</tt><pre style="margin: 0em;">

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Questions:
1: Is there a way to let a perl script query itself or the perl
executable to determine how much memory it is currently using?  I'd
like to log the highwater mark at exit so we can watch this over time,
or possibly exit when &quot;250MB&quot; is used and give the user instructions
on upping the limit in a config file after upping the ulimit value.
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>I'm not aware of a smart way. On Linux you could always run fork a &quot;ps  
</tt><tt>-ef&quot; and find yourself.
</tt><pre style="margin: 0em;">

irc.perl.org #perl-help might be helpful.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
2: Can the signal be captured in a handler?  If I read chapter 17 of
the OReilly &quot;Learning Perl 3rd Edition&quot;, it says that they can't be
trapped... :-(
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>If the OS sends the signal to perl then it's trivial to assign that  
</tt><tt>signal to a subroutine and Do The Right Thing... In Linux, anyway. I  
</tt><tt>don't know anything about Windows.  :)
</tt><pre style="margin: 0em;">

   <a  rel="nofollow" href="http://perldoc.perl.org/perlipc.html#Signals">http://perldoc.perl.org/perlipc.html#Signals</a>

HTH,

j



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="02230" href="msg02230.html">Re: [Omaha.pm] Self monitoring a perl scripts memory usage...</a></strong>
<ul><li><em>From:</em> Dan Linder &lt;dan@linder.org&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="02218" href="msg02218.html">[Omaha.pm] Self monitoring a perl scripts memory usage...</a></strong>
<ul><li><em>From:</em> Dan Linder &lt;dan@linder.org&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02220.html">Re: [Omaha.pm] Catalyst</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02222.html">Re: [Omaha.pm] Catalyst</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02218.html">[Omaha.pm] Self monitoring a perl scripts memory usage...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02230.html">Re: [Omaha.pm] Self monitoring a perl scripts memory usage...</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02221"><strong>Date</strong></a></li>
<li><a href="threads.html#02221"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
