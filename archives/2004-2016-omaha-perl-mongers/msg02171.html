<!-- MHonArc v2.6.24 -->
<!--X-Subject: Re: [Omaha.pm] [olug] Yesterday's dd&#45;wrt release fixes vulnerability -->
<!--X-From-R13: Dbo Fbjayrl &#60;ebo.gbjayrlNtznvy.pbz> -->
<!--X-Date: 24 Jul 2009 21:37:33 &#45;0000 -->
<!--X-Message-Id: 7e84ed60907241437h2d93063bp32ab2014fdfec648@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 4a67a69e.1b025a0a.682a.1166@mx.google.com -->
<!--X-Reference: d74b4e610907221810w113bc7c9qe52db756cbe495d0@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [Omaha.pm] [olug] Yesterday's dd-wrt release fixes vulnerability</title>
<link rev="made" href="mailto:rob.townley@gmail.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02170.html">Date Prev</a>][<a href="msg02172.html">Date Next</a>][<a href="msg02170.html">Thread Prev</a>][<a href="msg02172.html">Thread Next</a>][<a href="maillist.html#02171">Date Index</a>][<a href="threads.html#02171">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [Omaha.pm] [olug] Yesterday's dd-wrt release fixes vulnerability</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Omaha Linux User Group &lt;<a href="mailto:olug%40olug.org">olug@olug.org</a>&gt;, &quot;Perl Mongers of Omaha,	Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;, <a href="mailto:odynug%40googlegroups.com">odynug@googlegroups.com</a></li>
<li><em>Subject</em>: Re: [Omaha.pm] [olug] Yesterday's dd-wrt release fixes vulnerability</li>
<li><em>From</em>: Rob Townley &lt;<a href="mailto:rob.townley%40gmail.com">rob.townley@gmail.com</a>&gt;</li>
<li><em>Date</em>: Fri, 24 Jul 2009 16:37:25 -0500</li>
<li><em>Delivered-to</em>: <a href="mailto:mailman-omaha-pm%40mailman.pm.dev">mailman-omaha-pm@mailman.pm.dev</a></li>
<li><em>Delivered-to</em>: <a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:received:reply-to:in-reply-to	:references:date:message-id:subject:from:to:content-type	:content-transfer-encoding;	bh=wN6fYW6wpZG4bhh/+znyQU9E35SSyvrW8TPRoGNQi84=;	b=BB5txLPD/C1vbZsHSxObtvKCpoYi+VZm6DZCzkEnjU3Cx8Zr7dr3+H0cAz6EEO1OwC	ogC206ewVsZKg1JhByRFFrVJ3PnpMz6THiCWIXYfPYPRJXowqLDVKvmnJdRPY2HL+sS9	AE8vclWM3JVncFYwNwRGrc1ccGb1THaVPlQhg=</li>
<li><em>Domainkey-signature</em>: a=rsa-sha1; c=nofws; d=gmail.com; s=gamma;	h=mime-version:reply-to:in-reply-to:references:date:message-id	:subject:from:to:content-type:content-transfer-encoding;	b=OCBHQc3DMXIgFtXYnmXzFcgwnTZ+CNK1g6IA6CnYkrVkXpJPuq6WTGrkmcpG9LyjCE	NTWGUDDuDPo28XNlr1kWItyee7thwbY3yYeU6PFM00ABnvGxvknShvRypG4Pvt6l/6QW	UFdGGqQZNEXDmfp7zTDjstsVmQDhREk+cpTJM=</li>
<li><em>In-reply-to</em>: &lt;d74b4e610907221810w113bc7c9qe52db756cbe495d0@mail.gmail.com&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://mail.pm.org/pipermail/omaha-pm">http://mail.pm.org/pipermail/omaha-pm</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:omaha-pm-request@pm.org?subject=help">mailto:omaha-pm-request@pm.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: &quot;Perl Mongers of Omaha, Nebraska USA&quot; &lt;omaha-pm.pm.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:omaha-pm@pm.org">mailto:omaha-pm@pm.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://mail.pm.org/mailman/listinfo/omaha-pm">http://mail.pm.org/mailman/listinfo/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=subscribe">mailto:omaha-pm-request@pm.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://mail.pm.org/mailman/options/omaha-pm">http://mail.pm.org/mailman/options/omaha-pm</a>&gt;,	&lt;<a href="mailto:omaha-pm-request@pm.org?subject=unsubscribe">mailto:omaha-pm-request@pm.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;4a67a69e.1b025a0a.682a.1166@mx.google.com&gt;	&lt;d74b4e610907221810w113bc7c9qe52db756cbe495d0@mail.gmail.com&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:Rob.Townley%40gmail.com">Rob.Townley@gmail.com</a>, &quot;Perl Mongers of Omaha,	Nebraska USA&quot; &lt;<a href="mailto:omaha-pm%40pm.org">omaha-pm@pm.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Wed, Jul 22, 2009 at 8:10 PM, Chad Homan&lt;choman@gmail.com&gt; wrote:
&gt; I've dug into this a little but. The bug exist in the v24 sp1 firmware.
&gt; I personally have been running the June 19 pre-sp2 release which also has
&gt; the bug.
&gt;
&gt; If your running anything prior to v24 sp1, you can run the test rob privided
&gt;
&gt; and verify that the bug effects you
&gt;
&gt; There are two fixes posted currently, both available on the dd-wrt home
&gt; page.
&gt; Note that the suggested firmware fix is temporary until the router DB is
&gt; updated.
&gt; well according to the website
&gt;
&gt; Chad, CISSP
&gt;
&gt;
&gt;
&gt; On Wed, Jul 22, 2009 at 6:54 PM, Cheyenne Deal &lt;deal.cheyenne@gmail.com&gt;wrote:
&gt;
&gt;&gt; When did the problem start, I have a 04/07 release 07 as in 2007
&gt;&gt;
&gt;&gt; -----Original Message-----
&gt;&gt; From: Rob Townley &lt;rob.townley@gmail.com&gt;
&gt;&gt; Sent: Wednesday, July 22, 2009 6:31 PM
&gt;&gt; To: Omaha Linux User Group &lt;olug@olug.org&gt;
&gt;&gt; Subject: [olug] Yesterday's dd-wrt release fixes vulnerability
&gt;&gt;
&gt;&gt; If you have dd-wrt firmware, you will want to update. &#xA0;There is a
&gt;&gt; vulnerability in it that malicious website code could get root just by
&gt;&gt; visiting that malicious website from behind your dd-wrt firewall, CSRF
&gt;&gt; style.
&gt;&gt;
&gt;&gt; Test: &#xA0; &#xA0;<a  rel="nofollow" href="http://192.168.1.1/cgi-bin/;reboot">http://192.168.1.1/cgi-bin/;reboot</a>
&gt;&gt; _______________________________________________
&gt;&gt; OLUG mailing list
&gt;&gt; OLUG@olug.org
&gt;&gt; <a  rel="nofollow" href="https://lists.olug.org/mailman/listinfo/olug">https://lists.olug.org/mailman/listinfo/olug</a>
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; OLUG mailing list
&gt;&gt; OLUG@olug.org
&gt;&gt; <a  rel="nofollow" href="https://lists.olug.org/mailman/listinfo/olug">https://lists.olug.org/mailman/listinfo/olug</a>
&gt;&gt;
&gt; _______________________________________________
&gt; OLUG mailing list
&gt; OLUG@olug.org
&gt; <a  rel="nofollow" href="https://lists.olug.org/mailman/listinfo/olug">https://lists.olug.org/mailman/listinfo/olug</a>
&gt;

Cross Site Request Forgery highlights a much broader security problem
for just about anything that has a web based interface - printers,
cameras, firewalls, switches, webmin, nagios, CUPS, web based address
books, web based email and .  i am going to pick on webmin to remind
professionals that this type of attack applies to you even if you do
not use dd-wrt.   CSRF / XSRF allows malicious code on an internet
website to call code on a private only webmin interface.  Since google
and HoneyNET project research suggest there could be millions of
websites hacked, we really can't trust any website.  What frustrates
me is having webmin type browser sessions only accessible via https
can actually make the problem worse.

For the web developers out there such as the developers of the IE6
only Cisco SRW2048 and a local Omahan that commented that he will
never develop web apps for Safari again because there is no need, test
your code in multiple browsers because users need to easily be able to
use one brand of browser for web based administration and another
brand for browsing the web and yet another brand for web based email,
calendering, and contacts.   Yes, the alternative is to have multiple
user profiles for the same browser, but that does not always work for
me.

If you use dd-wrt, check back often to see if there are updates.
After using soho firewalls for more than a decade, dd-wrt is still
safer than most any other i have used.  The open-wrt ssh base was not
at fault here, it was the more closed web based interface.


Below is gat3way's dd-wrt  forum posting used for reference:
<a  rel="nofollow" href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=55173">http://www.dd-wrt.com/phpBB2/viewtopic.php?t=55173</a>
	
Posted: Fri Jul 24, 2009 7:48 am
The patch makes that exploit impossible to succeed even though it does
not thoroughly mitigate the CSRF attack vectors. That because now:

1) you have to be already authorized (before the fix it was possible
to execute commands via /cgi-bin without authorization)
2) the CSRF attack has to come from a https site, otherwise a referer
header is sent, it's checked against the httpd server hostname and
since it won't match, the request will be rejected.

OTOH, older POST-based CSRF could work if the attack comes from a
https site AND if you have already authorized at the web ui.

In other words, preventing CSRF attacks now will be easy if users just
follow a simple rule: when you login at the web management ui, do your
job, DO NOT browse other sites in other tabs (actually, closing all
tabs except the dd-wrt one is best), then log-out from the dd-wrt web
ui and continue browsing other sites. This way, you can be almost sure
no CSRF attack will be possible.

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="02172" href="msg02172.html">Re: [Omaha.pm] [olug] Yesterday's dd-wrt release fixes vulnerability</a></strong>
<ul><li><em>From:</em> Rob Townley &lt;rob.townley@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02170.html">[Omaha.pm] Next meeting: Tue Aug 11, 2009</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02172.html">Re: [Omaha.pm] [olug] Yesterday's dd-wrt release fixes vulnerability</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02170.html">[Omaha.pm] Next meeting: Tue Aug 11, 2009</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02172.html">Re: [Omaha.pm] [olug] Yesterday's dd-wrt release fixes vulnerability</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02171"><strong>Date</strong></a></li>
<li><a href="threads.html#02171"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
